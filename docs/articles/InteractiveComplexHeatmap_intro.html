<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How to visualize complex heatmaps interactively • InteractiveComplexHeatmap</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="How to visualize complex heatmaps interactively">
<meta property="og:description" content="InteractiveComplexHeatmap">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">InteractiveComplexHeatmap</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.11.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/InteractiveComplexHeatmap_intro.html">How to visualize complex heatmaps interactively</a>
    </li>
    <li>
      <a href="../articles/implementation.html">How interactive complex heatmap is implemented</a>
    </li>
    <li>
      <a href="../articles/shiny_dev.html">Functions for Shiny app development</a>
    </li>
    <li>
      <a href="../articles/decoration.html">Decorations on heatmaps</a>
    </li>
    <li>
      <a href="../articles/interactivate_indirect.html">Interactivate heatmaps indirectly generated by pheatmap(), heatmap.2() and heatmap()</a>
    </li>
    <li>
      <a href="../articles/deseq2_app.html">A Shiny app for visualizing DESeq2 results</a>
    </li>
    <li>
      <a href="../articles/from_scratch.html">Implement interactive heatmap from scratch</a>
    </li>
    <li>
      <a href="../articles/share.html">Share interactive heatmaps to collaborators</a>
    </li>
    <li>
      <a href="https://www.biorxiv.org/content/10.1101/2021.03.08.434289v7.full.pdf" class="external-link">PDF version</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jokergoo/InteractiveComplexHeatmap/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>How to visualize complex heatmaps interactively</h1>
                        <h4 data-toc-skip class="author">Zuguang Gu ( <a href="mailto:z.gu@dkfz.de" class="email">z.gu@dkfz.de</a> )</h4>
            
            <h4 data-toc-skip class="date">2024-02-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jokergoo/InteractiveComplexHeatmap/blob/HEAD/vignettes/InteractiveComplexHeatmap_intro.Rmd" class="external-link"><code>vignettes/InteractiveComplexHeatmap_intro.Rmd</code></a></small>
      <div class="hidden name"><code>InteractiveComplexHeatmap_intro.Rmd</code></div>

    </div>

    
    
<style>
p {
    margin: 1em 0;
}
img {
    background-color: #FFFFFF;
    padding: 2px;
    border: 1px solid #DDDDDD;
    border-radius: 3px;
    border: 1px solid #CCCCCC;
    margin: 0 5px;
}
</style>
<div class="section level2">
<h2 id="install">Install<a class="anchor" aria-label="anchor" href="#install"></a>
</h2>
<p>Package <strong>InteractiveComplexHeatmap</strong> is available on <a href="https://bioconductor.org/packages/InteractiveComplexHeatmap/" class="external-link">Bioconductor</a>, you can install it by:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"InteractiveComplexHeatmap"</span><span class="op">)</span></span></code></pre></div>
<p>If you want the latest version, install it directly from GitHub:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"jokergoo/InteractiveComplexHeatmap"</span><span class="op">)</span></span></code></pre></div>
<p>A printer-friendly version of the documentation is available at <a href="https://doi.org/10.1101/2021.03.08.434289" class="external-link">bioRxiv</a>.</p>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>The <strong>InteractiveComplexHeatmap</strong> package is very straightforward to use. For any heatmap (or list of heatmaps as a <code>Heatmap</code> or <code>HeatmapList</code> object) produced from <strong>ComplexHeatmap</strong> package, you just use the function <code><a href="../reference/htShiny.html">htShiny()</a></code> to export it as a Shiny app.</p>
<p>You can copy and paste the following code:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/ComplexHeatmap" class="external-link">ComplexHeatmap</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/InteractiveComplexHeatmap" class="external-link">InteractiveComplexHeatmap</a></span><span class="op">)</span></span>
<span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">ht</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="va">ht</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">ht</span><span class="op">)</span> <span class="co"># not necessary, but recommended</span></span>
<span></span>
<span><span class="fu"><a href="../reference/htShiny.html">htShiny</a></span><span class="op">(</span><span class="va">ht</span><span class="op">)</span></span></code></pre></div>
<p>A link will be automatically opend in your web browser (or a pop-up window in RStudio IDE).</p>
<p>To use <code><a href="../reference/htShiny.html">htShiny()</a></code>, the heatmap object is recommended to be updated with the function <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw()</a></code>. If it has not been updated, it will be applied inside <code><a href="../reference/htShiny.html">htShiny()</a></code> automatically. Updating by <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw()</a></code> speeds up loading the Shiny application because <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw()</a></code> applies clusterings which is normally the most time-consuming step in heatmap generation. After <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw()</a></code> is executed, clustering results are saved in the returned heatmap object so that repeatedly drawing heatmap can directly use the saved clustering results. If the heatmap includes randomness, such as <em>k</em>-means clustering by setting <code>row_km</code> or <code>column_km</code> argument or using random colors for annotations, it is necessary to execute <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw()</a></code> before sending the heatmap object to <code><a href="../reference/htShiny.html">htShiny()</a></code> to get rid of obtaining different heatmaps when executing <code><a href="../reference/htShiny.html">htShiny()</a></code> multiple times.</p>
<p>Following screenshot demonstrates the Shiny app on rather complex heatmaps. The data is from <a href="http://jokergoo.github.io/supplementary/ComplexHeatmap-supplementary1-4/supplS2_scRNASeq/supplS2_scRNAseq.html" class="external-link">here</a> and the app can be generated by running <code>htShinyExample(4.2)</code>.</p>
<script>
document.write('<img src="https://user-images.githubusercontent.com/449218/110212910-e6147e00-7e9d-11eb-94ed-0ac549247888.gif" width="100%" />');
</script><p>In this Shiny app, users can click on the orignal heatmap or select an area from it. The information of the cell or the area selected by users can be found in the text below the heatmaps. If an area is selected, a sub-heatmap is drawn on the right side of the app. Both heatmaps can be resized by dragging from the bottom right.</p>
<p>There are several tools under both heatmaps. For the original heatmap, there are following tools:</p>
<ol style="list-style-type: decimal">
<li><em>Search heatmap</em></li>
</ol>
<p>It allows to search the heatmap labels to obtain a subset of rows and columns. Once rows or columns are found in the heatmaps, the sub-heatmaps will be drawn in the right panel.</p>
<script>
document.write('<img src="https://jokergoo.github.io/images/tool_search.png" width="100%" />');
</script><ol start="2" style="list-style-type: decimal">
<li><em>Configure brush</em></li>
</ol>
<p>Border and backgroud of the brush can be configured here:</p>
<script>
document.write('<img src="https://jokergoo.github.io/images/tool_brush.png" width="100%" />');
</script><ol start="3" style="list-style-type: decimal">
<li><em>Save image</em></li>
</ol>
<p>The main heatmap can be saved into a file with one of the three formats (<code>png</code>, <code>pdf</code> and <code>svg</code>).</p>
<script>
document.write('<img src="https://jokergoo.github.io/images/tool_save_image.png" width="70%" />');
</script><ol start="4" style="list-style-type: decimal">
<li><em>Resize image</em></li>
</ol>
<p>The size of the original heatmap can be controlled by dragging the box, however, it can be precisely controlled by entering the width and height, as shown in the following figure:</p>
<script>
document.write('<img src="https://jokergoo.github.io/images/tool_resize.png" width="70%" />');
</script><p>For the sub-heatmap, there are following tools:</p>
<ol style="list-style-type: decimal">
<li><em>Configure sub-heatmap</em></li>
</ol>
<p>There are three sections of controls. 1. Basic controls such as whether to show row or column names, 2. Brushing on the original heatmap might not precisely capture rows or columns users expected. You can manually remove a certain number of rows or columns from the four dimensions of the selected sub-heatmap. 3. Selected sub-heatmap can be further converted into a second interactive heatmap application.</p>
<script>
document.write('<img src="https://jokergoo.github.io/images/tool_subheatmap.png" width="40%" />');
</script><ol start="2" style="list-style-type: decimal">
<li><em>Export table</em></li>
</ol>
<p>The values in the sub-heatmaps can be viewed and exported as a text table:</p>
<script>
document.write('<img src="https://jokergoo.github.io/images/tool_table.png" width="90%" />');
</script><ol start="3" style="list-style-type: decimal">
<li><em>Save sub-heatmap as an image</em></li>
</ol>
<p>Similar as in the main heatmap.</p>
<ol start="4" style="list-style-type: decimal">
<li><em>Resize sub-heatmap</em></li>
</ol>
<p>Similar as in the main heatmap.</p>
<p>There are other vignettes focusing on more specific topics:</p>
<ul>
<li><a href="implementation.html">How interactive ComplexHeatmap is implemented</a></li>
<li><a href="shiny_dev.html">Functions for Shiny app development</a></li>
<li><a href="decoration.html">Decorations on the heatmaps</a></li>
<li><a href="interactivate_indirect.html">Interactivate heatmaps indirectly generated by pheatmap(), heatmap.2() and heatmap()</a></li>
</ul>
</div>
<div class="section level2">
<h2 id="use-last-generated-heatmaps">Use last generated heatmaps<a class="anchor" aria-label="anchor" href="#use-last-generated-heatmaps"></a>
</h2>
<p><strong>ComplexHeatmap</strong> is broadly used in many other scripts and packages where they do not directly return the <code>Heatmap</code>/<code>HeatmapList</code> object. This is of no problem to make these heatmaps interactive because the last generated heatmap object is automatically saved and calling <code><a href="../reference/htShiny.html">htShiny()</a></code> without the heatmap object will automatically use the last one (by internally using the function <code>ComplexHeatmap:::get_last_ht()</code>). I demonstrate this functionality with <a href="https://bioconductor.org/packages/cola/" class="external-link">the <strong>cola</strong> pacakge</a>.</p>
<p><strong>cola</strong> package heavily uses <strong>ComplexHeatmap</strong> to implement various customized heatmaps to visualize consensus clustering results as well as downstream analysis. As an example, the function <code><a href="https://rdrr.io/pkg/cola/man/get_signatures-dispatch.html" class="external-link">get_signatures()</a></code> extracts signatures that are significantly different between the predicted subgroups. <code><a href="https://rdrr.io/pkg/cola/man/get_signatures-dispatch.html" class="external-link">get_signatures()</a></code> makes one heatmap and returns a data frame of the signatures as well as various statistics for the test. When <code><a href="https://rdrr.io/pkg/cola/man/get_signatures-dispatch.html" class="external-link">get_signatures()</a></code> draws the heatmap, the heatmap object is saved internally, then directly calling <code><a href="../reference/htShiny.html">htShiny()</a></code> without the heatmap object will convert the static signature heatmap into an interactive one:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the following code is runable</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/cola" class="external-link">cola</a></span><span class="op">)</span>  <span class="co"># cola is from Bioconductor</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">golub_cola</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/cola/man/get_signatures-dispatch.html" class="external-link">get_signatures</a></span><span class="op">(</span><span class="va">golub_cola</span><span class="op">[</span><span class="st">"ATC:skmeans"</span><span class="op">]</span>, k <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># this makes the heatmap</span></span>
<span><span class="fu"><a href="../reference/htShiny.html">htShiny</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<script>
document.write('<img src="https://jokergoo.github.io/images/signature_heatmap.png" width="100%" />');
</script><p>Note the functionality of automatically saving the last heatmap is only turned on when <strong>InteractiveComplexHeatmap</strong> packags is loaded, which means, <code><a href="https://github.com/jokergoo/InteractiveComplexHeatmap" class="external-link">library(InteractiveComplexHeatmap)</a></code> should be called before making the heatmap, or you need to explicitly set <code>ComplexHeatmap::ht_opt(save_last = TRUE)</code>.</p>
<p>Examples are in <code>htShinyExample(1.6)</code> and <code>htShinyExample(1.7)</code>.</p>
<p>Nevertheless, if possible, I still suggest to explictly put the heatmap object in <code><a href="../reference/htShiny.html">htShiny()</a></code> which makes it clear which heatmap is becoming interactive.</p>
</div>
<div class="section level2">
<h2 id="recursive-interactive-heatmap-widgets">Recursive interactive heatmap widgets<a class="anchor" aria-label="anchor" href="#recursive-interactive-heatmap-widgets"></a>
</h2>
<p>In the right panel there is the sub-heatmap that is selected from the left panel. When the original heatmap is very huge, even a tiny selection rectangle still generates a dense sub-heatmap where single cells are very hard to identify and read. In this case, the sub-heatmap can be continually exported as another independent interactive heatmap widget which is in a new layer above current one, just by clicking the button “Interactivate sub-heatmap” under the sub-heatmap. This process can be recursively applied untill you are satisfied with the details you can see in the sub-heatmap. An example is as follows:</p>
<script>
document.write('<img src="https://jokergoo.github.io/images/recursive.gif" width="100%" />');
</script>
</div>
<div class="section level2">
<h2 id="float-output-to-mouse-positions">Float output to mouse positions<a class="anchor" aria-label="anchor" href="#float-output-to-mouse-positions"></a>
</h2>
<p>The output which contains information of the clicked cell or the sub-heatmap by default is placed below the heatmaps. Argument <code>output_ui_float</code> can be set to <code>TRUE</code> so that the output is floating to the positions of mouse.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/htShiny.html">htShiny</a></span><span class="op">(</span><span class="va">ht</span>, output_ui_float <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>There are two examples: <code>htShinyExample(9.1)</code> and <code>htShinyExample(9.2)</code>. The demonstration is as follows:</p>
<script>
document.write('<img src="https://jokergoo.github.io/images/float1.gif" width="100%" />');
</script><p>As will be explained in <a href="shiny_dev.html">the vignette “Functions for Shiny app development”</a>, the output can be self-defined to put customized information. The self-defined output can also be floated:</p>
<script>
document.write('<img src="https://jokergoo.github.io/images/float2.gif" width="100%" />');
</script>
</div>
<div class="section level2">
<h2 id="layout">Layout<a class="anchor" aria-label="anchor" href="#layout"></a>
</h2>
<p>There are three main components in the interactive heatmap UI, <em>i.e.</em>, the orignal heatmap, the sub-heatmap and an output that shows information of the clicked cell or the selected sub-heatmap. The layout of the three components are controlled via <code>layout</code> argument, see <a href="shiny_dev.html#customize-the-widgets">the vignette “Functions for Shiny app development”</a> for detailed explanation of the <code>layout</code> argument.</p>
</div>
<div class="section level2">
<h2 id="only-respond-to-one-event">Only respond to one event<a class="anchor" aria-label="anchor" href="#only-respond-to-one-event"></a>
</h2>
<p>The argument <code>response</code> can be set as one of <code>"click"</code>, <code>"hover"</code>, <code>"dblclick"</code>, <code>"brush"</code> and <code>"brush-output"</code> to only respond to one event on heatmap. E.g. if <code>response</code> is set to <code>"click"</code>, there will be no response for the “brush event” in the interactive heatmap, also the sub-heatmap component is removed from the app.</p>
<p>Brushing on heatmap by default triggers two reponses: update in the sub-heatmap and update in the output. If <code>response</code> is set to <code>"brush-output"</code>, brushing will only trigger changes in the output and there will be no sub-heatmap component in the app.</p>
<p>The following figure demonstrates only responding to <code>"click"</code> or <code>"brush"</code> where the output floats at mouse positions. Runnable examples are in <code>htShinyExample(1.9)</code> and <code>htShinyExample(9.3)</code>.</p>
<script>
document.write('<img src="https://jokergoo.github.io/images/response.gif" width="100%" />');
</script>
</div>
<div class="section level2">
<h2 id="compact-mode">Compact mode<a class="anchor" aria-label="anchor" href="#compact-mode"></a>
</h2>
<p>By default all the three UI components are includedin the app. In <code><a href="../reference/htShiny.html">htShiny()</a></code>, the argument <code>compact</code> can be set to <code>TRUE</code> so that the sub-heatmap component is removed and the output floats at mouse positions:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/htShiny.html">htShiny</a></span><span class="op">(</span><span class="va">ht</span>, compact <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<script>
document.write('<img src="https://jokergoo.github.io/images/compact.gif" width="80%" />');
</script>
</div>
<div class="section level2">
<h2 id="other-arguments-in-htshiny">Other arguments in <code>htShiny()</code><a class="anchor" aria-label="anchor" href="#other-arguments-in-htshiny"></a>
</h2>
<p><code><a href="../reference/htShiny.html">htShiny()</a></code> is just a simple wrapper on the other two basic functions <code><a href="../reference/InteractiveComplexHeatmapOutput.html">InteractiveComplexHeatmapOutput()</a></code> and <code><a href="../reference/makeInteractiveComplexHeatmap.html">makeInteractiveComplexHeatmap()</a></code>. Users can go to the vignette <a href="shiny_dev.html">“Functions for Shiny app development”</a> for more customized controls.</p>
</div>
<div class="section level2">
<h2 id="live-examples">Live examples<a class="anchor" aria-label="anchor" href="#live-examples"></a>
</h2>
<p>The following code demostrates two horizontally concatenated heatmaps. Please visit <a href="https://jokergoo.shinyapps.io/interactive_complexheatmap/" class="external-link uri">https://jokergoo.shinyapps.io/interactive_complexheatmap/</a> for a live demo.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">mat1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat1</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat1</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">mat2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat2</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat2</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ht_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span><span class="va">mat1</span>, name <span class="op">=</span> <span class="st">"mat_a"</span>, row_km <span class="op">=</span> <span class="fl">2</span>, column_km <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span><span class="va">mat2</span>, name <span class="op">=</span> <span class="st">"mat_b"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/htShiny.html">htShiny</a></span><span class="op">(</span><span class="va">ht_list</span><span class="op">)</span></span></code></pre></div>
<p>The following code demostrates two vertically concatenated heatmaps. Check <a href="https://jokergoo.shinyapps.io/interactive_complexheatmap_vertical/" class="external-link uri">https://jokergoo.shinyapps.io/interactive_complexheatmap_vertical/</a> for a live demo.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ht_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span><span class="va">mat1</span>, name <span class="op">=</span> <span class="st">"mat_a"</span>, row_km <span class="op">=</span> <span class="fl">2</span>, column_km <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/pct_v_pct.html" class="external-link">%v%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span><span class="va">mat2</span>, name <span class="op">=</span> <span class="st">"mat_b"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/htShiny.html">htShiny</a></span><span class="op">(</span><span class="va">ht_list</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="integrate-with-other-plots-and-packages">Integrate with other plots and packages<a class="anchor" aria-label="anchor" href="#integrate-with-other-plots-and-packages"></a>
</h2>
<p>The functionality of the interactivity is general. It can be applied to any heatmap as long as it is generated from the <strong>ComplexHeatmap</strong> package. Thus, it can turn many other plots into an interactive app.</p>
<div class="section level3">
<h3 id="interactive-density-heatmap">Interactive density heatmap<a class="anchor" aria-label="anchor" href="#interactive-density-heatmap"></a>
</h3>
<p><code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/densityHeatmap.html" class="external-link">ComplexHeatmap::densityHeatmap()</a></code> returns a <code>Heatmap</code> object, so it can be exported as a Shiny app. Check <a href="https://jokergoo.shinyapps.io/interactive_densityheatmap/" class="external-link uri">https://jokergoo.shinyapps.io/interactive_densityheatmap/</a> for a live demo. The example can also be run locally by executing <code>htShinyExample(2.1)</code>. The usage of <code><a href="../reference/htShinyExample.html">htShinyExample()</a></code> will be introduced later and in the webpage opened by <code><a href="../reference/htShinyExample.html">htShinyExample()</a></code> there is also the source code for generating this Shiny app.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ht</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/densityHeatmap.html" class="external-link">densityHeatmap</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/htShiny.html">htShiny</a></span><span class="op">(</span><span class="va">ht</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="interactive-oncoprint">Interactive oncoPrint<a class="anchor" aria-label="anchor" href="#interactive-oncoprint"></a>
</h3>
<p><code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/oncoPrint.html" class="external-link">ComplexHeatmap::oncoPrint()</a></code> returns a <code>Heatmap</code> object, thus, the oncoPrint can be interactive. Example code is as follows. Check <a href="https://jokergoo.shinyapps.io/interactive_oncoprint/" class="external-link uri">https://jokergoo.shinyapps.io/interactive_oncoprint/</a> for a live demo. The example can be run locally by executing <code>htShinyExample(2.2)</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ht</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/oncoPrint.html" class="external-link">oncoPrint</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/htShiny.html">htShiny</a></span><span class="op">(</span><span class="va">ht</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ht</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/oncoPrint.html" class="external-link">oncoPrint</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/rowAnnotation.html" class="external-link">rowAnnotation</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/htShiny.html">htShiny</a></span><span class="op">(</span><span class="va">ht</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="interactive-upset-plot">Interactive UpSet plot<a class="anchor" aria-label="anchor" href="#interactive-upset-plot"></a>
</h3>
<p><code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/UpSet.html" class="external-link">ComplexHeatmap::UpSet()</a></code> returns a <code>Heatmap</code> object, thus, the UpSet plot generated by <strong>ComplexHeatmap</strong> can be interactive. It might be useful when you visualize many sets at the same time. Example code is as follows. Check <a href="https://jokergooo.shinyapps.io/interactive_upset/" class="external-link uri">https://jokergooo.shinyapps.io/interactive_upset/</a> for a live demo. The example can be run locally by executing <code>htShinyExample(2.3)</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/make_comb_mat.html" class="external-link">make_comb_mat</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span><span class="va">ht</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/UpSet.html" class="external-link">UpSet</a></span><span class="op">(</span><span class="va">cm</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/htShiny.html">htShiny</a></span><span class="op">(</span><span class="va">ht</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="interactive-enriched-heatmap">Interactive enriched heatmap<a class="anchor" aria-label="anchor" href="#interactive-enriched-heatmap"></a>
</h3>
<p><a href="https://www.bioconductor.org/packages/release/bioc/html/EnrichedHeatmap.html" class="external-link"><strong>EnrichedHeatmap</strong></a> inherits <strong>ComplexHeatmap</strong> and it outputs <code>Heatmap</code> objects, thus, an “enriched heatmap” can be exported as a Shiny app as well. Check <a href="https://jokergoo.shinyapps.io/interactive_enrichedheatmap/" class="external-link uri">https://jokergoo.shinyapps.io/interactive_enrichedheatmap/</a> for a live demo. The example can be run locally by executing <code>htShinyExample(3.1)</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mat</span> <span class="op">=</span> <span class="fu">normalizeToMatrix</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span><span class="va">ht</span> <span class="op">=</span> <span class="fu">EnrichedHeatmap</span><span class="op">(</span><span class="va">mat</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/htShiny.html">htShiny</a></span><span class="op">(</span><span class="va">ht</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ht</span> <span class="op">=</span> <span class="fu">EnrichedHeatmap</span><span class="op">(</span><span class="va">mat</span>, <span class="va">...</span><span class="op">)</span> <span class="op">+</span> <span class="fu">EnrichedHeatmap</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/htShiny.html">htShiny</a></span><span class="op">(</span><span class="va">ht</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="interactive-pheatmap">Interactive pheatmap<a class="anchor" aria-label="anchor" href="#interactive-pheatmap"></a>
</h3>
<p>Since <strong>ComplexHeatmap</strong> can <a href="https://jokergoo.github.io/2020/05/06/translate-from-pheatmap-to-complexheatmap/" class="external-link">seamlessly integrate <strong>pheatmap</strong></a>, this means your pheatmap can be interactive! Check <a href="https://jokergooo.shinyapps.io/interactive_pheatmap/" class="external-link uri">https://jokergooo.shinyapps.io/interactive_pheatmap/</a>. The example can be run locally by executing <code>htShinyExample(2.4)</code>.</p>
<p><code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/pheatmap.html" class="external-link">ComplexHeatmap::pheatmap()</a></code> and <code><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html" class="external-link">pheatmap::pheatmap()</a></code> have the same set of arguments and generate almost the same heatmaps, but be careful when you directly use <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/pheatmap.html" class="external-link">pheatmap()</a></code> without the namespace prefix (the package name), you need to make sure it is from <strong>ComplexHeatmap</strong> if you want to use the interactive functionality.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ht</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/pheatmap.html" class="external-link">pheatmap</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="co"># ComplexHeatmap::pheatmap should overwrite pheatmap::pheatmap</span></span>
<span><span class="fu"><a href="../reference/htShiny.html">htShiny</a></span><span class="op">(</span><span class="va">ht</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="interactive-heatmap">Interactive heatmap<a class="anchor" aria-label="anchor" href="#interactive-heatmap"></a>
</h3>
<p>To facilitate the users who are still using <code><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap()</a></code> and <code>heatmap.2()</code> functions, to make the output of these two functions can be exported as interactive Shiny apps as well, from <strong>ComplexHeatmap</strong> version 2.7.2, two similar translation functions <code>ComplexHeatmap:::heatmap()</code> and <code>ComplexHeatmap:::heatmap.2()</code> which use the same set of arguments as the original functions and generate almost identical heatmaps. Then an interactive <code><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap()</a></code> will look like:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ht</span> <span class="op">=</span> <span class="fu">ComplexHeatmap</span><span class="fu">:::</span><span class="fu">heatmap</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/htShiny.html">htShiny</a></span><span class="op">(</span><span class="va">ht</span><span class="op">)</span></span></code></pre></div>
<p>As you see, <code><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap()</a></code> function is not exported from <strong>ComplexHeatmap</strong> (so that it will not conflict with <strong>stats</strong> package) and it should be explicitly specifid with <code>:::</code>.</p>
<p>An live example is at <a href="https://jokergooo.shinyapps.io/interactive_heatmap/" class="external-link uri">https://jokergooo.shinyapps.io/interactive_heatmap/</a>. The example can be run locally by executing <code>htShinyExample(2.5)</code>.</p>
</div>
<div class="section level3">
<h3 id="interactive-heatmap-2">Interactive heatmap.2<a class="anchor" aria-label="anchor" href="#interactive-heatmap-2"></a>
</h3>
<p>Similarly, an interactive <code>heatmap.2()</code> looks like:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ht</span> <span class="op">=</span> <span class="fu">ComplexHeatmap</span><span class="fu">:::</span><span class="fu">heatmap.2</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/htShiny.html">htShiny</a></span><span class="op">(</span><span class="va">ht</span><span class="op">)</span></span></code></pre></div>
<p>Similarlly, <code>heatmap.2()</code> is not exported from <strong>ComplexHeatmap</strong> (so that it will not conflict with <strong>glots</strong> package) and it should be specified with <code>:::</code>.</p>
<p>An live example is at <a href="https://jokergooo.shinyapps.io/interactive_heatmap_2/" class="external-link uri">https://jokergooo.shinyapps.io/interactive_heatmap_2/</a>. The example can be run locally by executing <code>htShinyExample(2.6)</code>.</p>
</div>
<div class="section level3">
<h3 id="interactive-tidyheatmap">Interactive tidyHeatmap<a class="anchor" aria-label="anchor" href="#interactive-tidyheatmap"></a>
</h3>
<p><a href="https://CRAN.R-project.org/package=tidyHeatmap" class="external-link">The <strong>tidyHeatmap</strong> package</a> basically wraps <strong>ComplexHeatmap</strong> and provides “a tidy way” for generating heatmaps. Since the final heatmap is actually generated by <strong>ComplexHeatmap</strong>, it can be directly exported as an interactive app. You can directly apply <code><a href="../reference/htShiny.html">htShiny()</a></code> on the object generated from <strong>tidyHeatmap</strong>. Check <a href="https://jokergooo.shinyapps.io/interactive_tidyheatmap/" class="external-link uri">https://jokergooo.shinyapps.io/interactive_tidyheatmap/</a>. The example can be run locally by executing <code>htShinyExample(2.7)</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.r-project.org" class="external-link">tidyHeatmap</a></span><span class="op">)</span></span>
<span><span class="va">mtcars_tidy</span> <span class="op">&lt;-</span> </span>
<span>    <span class="va">mtcars</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">as_tibble</span><span class="op">(</span>rownames<span class="op">=</span><span class="st">"Car name"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">mutate_at</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="op">-</span><span class="va">`Car name`</span>, <span class="op">-</span><span class="va">hp</span>, <span class="op">-</span><span class="va">vs</span><span class="op">)</span>, <span class="va">scale</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">`Car name`</span>, <span class="va">hp</span>, <span class="va">vs</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"Property"</span>, values_to <span class="op">=</span> <span class="st">"Value"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mtcars_heatmap</span> <span class="op">&lt;-</span> </span>
<span>    <span class="va">mtcars_tidy</span> <span class="op">%&gt;%</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap</a></span><span class="op">(</span><span class="va">`Car name`</span>, <span class="va">Property</span>, <span class="va">Value</span> <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">add_tile</span><span class="op">(</span><span class="va">hp</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/htShiny.html">htShiny</a></span><span class="op">(</span><span class="va">mtcars_heatmap</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="other-tips">Other tips<a class="anchor" aria-label="anchor" href="#other-tips"></a>
</h3>
<p>As explained before, for all these functions and packages that generate customized heatmaps, if the heatmaps are already generated in the interactive graphics device, the heatmap objects can be ommited when calling <code><a href="../reference/htShiny.html">htShiny()</a></code>. E.g.:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/pheatmap.html" class="external-link">pheatmap</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/htShiny.html">htShiny</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/oncoPrint.html" class="external-link">oncoPrint</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/htShiny.html">htShiny</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="examples-shipped-with-the-package">Examples shipped with the package<a class="anchor" aria-label="anchor" href="#examples-shipped-with-the-package"></a>
</h2>
<p>There are many other examples shipped with the <strong>InteractiveComplexHeatmap</strong> package. The list of examples can be obtained by executing <code><a href="../reference/htShinyExample.html">htShinyExample()</a></code> with no argument.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/htShinyExample.html">htShinyExample</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## There are following examples. Individual example can be run by e.g. htShinyExample(1.1).</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ──────── 1. Simple examples ───────────────────────────────────────────────────────── </span></span>
<span><span class="co">##  1.1 A single heatmap with minimal arguments.</span></span>
<span><span class="co">##  1.2 A single heatmap from a character matrix.</span></span>
<span><span class="co">##  1.3 A single heatmap with annotations on both rows and columns.</span></span>
<span><span class="co">##  1.4 A single heatmap where rows and columns are split.</span></span>
<span><span class="co">##  1.5 A list of two heatmaps.</span></span>
<span><span class="co">##  1.6 A list of two vertically concatenated heatmaps</span></span>
<span><span class="co">##  1.7 Use last generated heatmap, an example from cola package.</span></span>
<span><span class="co">##  1.8 Use last generated heatmap, an app with three interactive heatmaps</span></span>
<span><span class="co">##  1.9 Demonstrate hover, click and dblclick actions to select cells.</span></span>
<span><span class="co">##  1.10 Only response to one of click/hover/dblclick/hover events. Please use</span></span>
<span><span class="co">##       htShinyExample('1.10') to get this example (quote the index, or else</span></span>
<span><span class="co">##       htShinyExample(1.10) will be treated as the same as htShinyExample(1.1)).</span></span>
<span><span class="co">##  1.11 Interactive heatmap under compact mode.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ──────── 2. On other plots and packages ───────────────────────────────────────────── </span></span>
<span><span class="co">##  2.1 A density heatmap.</span></span>
<span><span class="co">##  2.2 An oncoPrint.</span></span>
<span><span class="co">##  2.3 A UpSet plot.</span></span>
<span><span class="co">##  2.4 An interactive heatmap from pheatmap().</span></span>
<span><span class="co">##  2.5 An interactive heatmap from heatmap().</span></span>
<span><span class="co">##  2.6 An interactive heatmap from heatmap.2().</span></span>
<span><span class="co">##  2.7 A heatmap produced from tidyHeatmap package.</span></span>
<span><span class="co">##  2.8 Genome-scale heatmap.</span></span>
<span><span class="co">##  2.9 A package-dependency heatmap. You can try to control "Fill figure region"</span></span>
<span><span class="co">##      and "Remove empty rows and columns" in the tools under the sub-heatmap.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ──────── 3. Enriched heatmaps ─────────────────────────────────────────────────────── </span></span>
<span><span class="co">##  3.1 A single enriched heatmap.</span></span>
<span><span class="co">##  3.2 A list of enriched heatmaps.</span></span>
<span><span class="co">##  3.3 An enriched heatmap with discrete signals.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ──────── 4. On public datasets ────────────────────────────────────────────────────── </span></span>
<span><span class="co">##  4.1 An example from Lewis et al 2019.</span></span>
<span><span class="co">##  4.2 Visualize cell heterogeneity from single cell RNASeq.</span></span>
<span><span class="co">##  4.3 Correlations between methylation, expression and other genomic features.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ──────── 5. Shiny app development ─────────────────────────────────────────────────── </span></span>
<span><span class="co">##  5.1 A single Shiny app with two interactive heatmap widgets.</span></span>
<span><span class="co">##  5.2 Self-define the output. The selected sub-matrix is shown as a text table.</span></span>
<span><span class="co">##  5.3 Self-define the output. Additional annotations for the selected genes are</span></span>
<span><span class="co">##      shown.</span></span>
<span><span class="co">##  5.4 Visualize Gene Ontology similarities. A list of selected GO IDs as well as</span></span>
<span><span class="co">##      their descriptions are shown in the output.</span></span>
<span><span class="co">##  5.5 Interactive correlation heatmap. Clicking on the cell generates a</span></span>
<span><span class="co">##      scatterplot of the two corresponding variables.</span></span>
<span><span class="co">##  5.6 A heatmap on Jaccard coefficients for a list of genomic regions. Clicking</span></span>
<span><span class="co">##      on the cell generates a Hilbert curve of how the two sets of genomic</span></span>
<span><span class="co">##      regions overlap.</span></span>
<span><span class="co">##  5.7 Implement interactivity from scratch. Instead of generating the whole</span></span>
<span><span class="co">##      interactive heatmap widget, it only returns the information of rows and</span></span>
<span><span class="co">##      columns that user have selected on heatmap and users can use this</span></span>
<span><span class="co">##      information to build their own interactive heatmap widgets.</span></span>
<span><span class="co">##  5.8 Implement interactivity from scratch. A visualization of 2D density</span></span>
<span><span class="co">##      distribution. Brushing on heatmap triggers a new 2D density estimation</span></span>
<span><span class="co">##      only on the subset of data.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ──────── 6. Dynamically generate heatmap widget in Shiny app ──────────────────────── </span></span>
<span><span class="co">##  6.1 The matrix with different dimensions is dynamically generated.</span></span>
<span><span class="co">##  6.2 Reorder by a column that is specified by user.</span></span>
<span><span class="co">##  6.3 Dynamically generate the widget with InteractiveComplexHeatmapModal(). The</span></span>
<span><span class="co">##      modal is triggered by an action button.</span></span>
<span><span class="co">##  6.4 Dynamically select interactive heatmaps. The modal is triggered by radio</span></span>
<span><span class="co">##      buttons.</span></span>
<span><span class="co">##  6.5 Dynamically generate the widget. A customized Javascript code is inserted</span></span>
<span><span class="co">##      after the UI to change the default behavior of the action button.</span></span>
<span><span class="co">##  6.6 The widget is generated by InteractiveComplexHeatmapWidget() where the UI</span></span>
<span><span class="co">##      is directly put in the place defined by htmlOutput().</span></span>
<span><span class="co">##  6.7 The widget is generated by InteractiveComplexHeatmapWidget() and a</span></span>
<span><span class="co">##      customized Javascript code is inserted after the UI.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ──────── 7. Interactive R markdown document ───────────────────────────────────────── </span></span>
<span><span class="co">##  7.1 Integrate in an interactive R Markdown document.</span></span>
<span><span class="co">##  7.2 Integrate in an interactive R Markdown document where the heatmap widgets</span></span>
<span><span class="co">##      are dynamically generated.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ──────── 8. Interactivate heatmaps indirectly generated by heatmap()/heatmap.2()/pheatmap()  </span></span>
<span><span class="co">##  8.1 Indirect use of pheatmap().</span></span>
<span><span class="co">##  8.2 Indirect use of heatmap.2().</span></span>
<span><span class="co">##  8.3 Two interactive heatmap widgets from indirect use of pheatmap().</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ──────── 9. Float output UI along with mouse positions ────────────────────────────── </span></span>
<span><span class="co">##  9.1 A simple example that demonstrates output UI floating with the three</span></span>
<span><span class="co">##      actions: hover, click and dblclick.</span></span>
<span><span class="co">##  9.2 Floating self-defined outputs.</span></span>
<span><span class="co">##  9.3 Floating output only from one event on heatmap, i.e.</span></span>
<span><span class="co">##      hover/click/dblclick/brush-output.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ──────── 10. Work with shinydashboard ──────────────────────────────────────────────── </span></span>
<span><span class="co">##  10.1 Separate the three UI components into three boxes.</span></span>
<span><span class="co">##  10.2 The three UI components are draggable.</span></span>
<span><span class="co">##  10.3 A Shiny dashboard with two tabs.</span></span>
<span><span class="co">##  10.4 Only contain the original heatmap where output floats.</span></span>
<span><span class="co">##  10.5 A complex dashboard that visualizes a DESeq2 results.</span></span></code></pre>
<p>You can select one specific example by sending the corresponding index to <code><a href="../reference/htShinyExample.html">htShinyExample()</a></code>, e.g. to run the example “1.4 A single heatmap where rows and columns are split.”, simply run:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/htShinyExample.html">htShinyExample</a></span><span class="op">(</span><span class="fl">1.4</span><span class="op">)</span></span></code></pre></div>
<p>Then the interactive heatmaps as well as the source code for generating the app will be available in the webpage.</p>
<p>Have fun!</p>
</div>
<div class="section level2">
<h2 id="sessioninfo">SessionInfo<a class="anchor" aria-label="anchor" href="#sessioninfo"></a>
</h2>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.3.1 (2023-06-16)</span></span>
<span><span class="co">## Platform: x86_64-apple-darwin20 (64-bit)</span></span>
<span><span class="co">## Running under: macOS Ventura 13.2.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] C/UTF-8/C/C/C/C</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: Europe/Berlin</span></span>
<span><span class="co">## tzcode source: internal</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] grid      stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">## [8] base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] InteractiveComplexHeatmap_1.11.1 ComplexHeatmap_2.18.0           </span></span>
<span><span class="co">## [3] knitr_1.44                      </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] circlize_0.4.15     shape_1.4.6         rjson_0.2.21       </span></span>
<span><span class="co">##  [4] xfun_0.40           bslib_0.6.1         GlobalOptions_0.1.2</span></span>
<span><span class="co">##  [7] vctrs_0.6.4         tools_4.3.1         stats4_4.3.1       </span></span>
<span><span class="co">## [10] parallel_4.3.1      cluster_2.1.4       RColorBrewer_1.1-3 </span></span>
<span><span class="co">## [13] desc_1.4.2          S4Vectors_0.40.2    webshot_0.5.5      </span></span>
<span><span class="co">## [16] lifecycle_1.0.4     compiler_4.3.1      stringr_1.5.0      </span></span>
<span><span class="co">## [19] textshaping_0.3.7   munsell_0.5.0       fontawesome_0.5.2  </span></span>
<span><span class="co">## [22] codetools_0.2-19    clue_0.3-65         httpuv_1.6.13      </span></span>
<span><span class="co">## [25] htmltools_0.5.7     sass_0.4.8          yaml_2.3.7         </span></span>
<span><span class="co">## [28] pkgdown_2.0.7       later_1.3.2         crayon_1.5.2       </span></span>
<span><span class="co">## [31] jquerylib_0.1.4     ellipsis_0.3.2      cachem_1.0.8       </span></span>
<span><span class="co">## [34] iterators_1.0.14    foreach_1.5.2       mime_0.12          </span></span>
<span><span class="co">## [37] rvest_1.0.3         digest_0.6.33       stringi_1.7.12     </span></span>
<span><span class="co">## [40] purrr_1.0.2         rprojroot_2.0.3     fastmap_1.1.1      </span></span>
<span><span class="co">## [43] colorspace_2.1-0    cli_3.6.2           magrittr_2.0.3     </span></span>
<span><span class="co">## [46] scales_1.2.1        promises_1.2.1      rmarkdown_2.25     </span></span>
<span><span class="co">## [49] httr_1.4.7          matrixStats_1.2.0   ragg_1.2.6         </span></span>
<span><span class="co">## [52] clisymbols_1.2.0    png_0.1-8           GetoptLong_1.0.5   </span></span>
<span><span class="co">## [55] kableExtra_1.3.4    memoise_2.0.1       shiny_1.8.0        </span></span>
<span><span class="co">## [58] evaluate_0.22       IRanges_2.36.0      doParallel_1.0.17  </span></span>
<span><span class="co">## [61] viridisLite_0.4.2   rlang_1.1.2         Rcpp_1.0.11        </span></span>
<span><span class="co">## [64] xtable_1.8-4        glue_1.6.2          xml2_1.3.6         </span></span>
<span><span class="co">## [67] BiocGenerics_0.48.1 svglite_2.1.2       rstudioapi_0.15.0  </span></span>
<span><span class="co">## [70] jsonlite_1.8.8      R6_2.5.1            systemfonts_1.0.5  </span></span>
<span><span class="co">## [73] fs_1.6.3</span></span></code></pre>
<script src="jquery.min.js"></script><script src="jquery.sticky.js"></script><script>
$(document).ready(function(){
    $("#TOC").sticky({
        topSpacing: 0,
        zIndex:1000    
    })
    $("#TOC").on("sticky-start", function() {

        $("<p style='font-size:1.2em; padding-left:4px;'><a id='TOC-click'>Table of Content</a></p>").insertBefore($("#TOC ul:first-child"));
        $("#TOC-click").hover(function() {
            $(this).css("color", "#0033dd").css("cursor", "pointer");
            $("#TOC").children().first().next().show();
            $("#TOC").hover(function() {
                $(this).children().first().next().show();
            }, function() {
                $(this).children().first().next().hide();
                $("body").off("hover", "#TOC");
            })
        }, function() {
            $(this).css("color", "#0033dd");
        })
        $("#TOC").children().first().next().hide();

    })
    $("#TOC").on("sticky-end", function() {
        $("#TOC").children().first().remove();
        $("#TOC").children().first().show();
    })
});
</script>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  <style>nav[data-toggle='toc'] .nav .nav {display: block;}</style>
</body>
</html>
